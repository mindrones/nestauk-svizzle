<script>
	import Switch from '@svizzle/ui/src/Switch.svelte';

	import RegionsSelector from 'components/RegionsSelector.svelte';

	const defaultHandlers = {
		toggledColorScheme: null,
		toggledFiltering: null,
		toggledRanking: null,
	}

	export let colorScheme = {
		value: 'Red-Blue',
		values: ['Red-Blue', 'Green-Blue']
	}
	export let flags = {
		doFilter: false,
		showRankingControl: false,
	}
	export let handlers = defaultHandlers;

	// FIXME https://github.com/sveltejs/svelte/issues/4442
	$: handlers = handlers ? {...defaultHandlers, ...handlers} : defaultHandlers;

	$: count = flags.showRankingControl ? 3 : 2
</script>

<div class='SettingsView'>
	<!-- geo selection -->
	<div class='setting'>
		<h2>1/{count}: NUTS1 regions</h2>
		<Switch
			value={flags.doFilter ? 'Filter' : 'Highlight'}
			values={['Highlight', 'Filter']}
			on:toggled={handlers.toggledFiltering}
		/>
		<div class='regions'>
			<RegionsSelector/>
		</div>
	</div>

	<!-- color scale -->
	<div class='setting'>
		<h2>2/{count}: Color scale</h2>
		<Switch
			value={colorScheme.value}
			values={colorScheme.values}
			on:toggled={handlers.toggledColorScheme}
		/>
	</div>

	<!-- ranking -->
	{#if flags.showRankingControl}
		<div class='setting'>
			<h2>3/{count}: Y scale</h2>
			<Switch
				value='Absolute'
				values={['Absolute', 'Ranking']}
				on:toggled={handlers.toggledRanking}
			/>
		</div>
	{/if}
</div>

<style>
	.SettingsView {
		align-items: center;
		display: flex;
		flex-direction: column;
		height: 100%;
		justify-content: flex-start;
		overflow-y: auto;
		width: 100%;
	}

	.setting {
		/* border: 1px solid var(--colorRefLight); */
		/* box-shadow: var(--dimBoxShadowXY) var(--colorRefLight); */
		align-items: center;
		background-color: white;
		display: flex;
		flex-direction: column;
		justify-content: center;
		padding: 0.5rem 0.5rem 1rem 0.5rem;
		width: 100%;
	}
	.setting:not(:last-child) {
		margin-bottom: 1.5rem;
	}
	h2 {
		margin-bottom: 1rem;
	}
	.regions {
		margin-top: 1rem;
	}
</style>
