import {objectToKeyValueArray} from '@svizzle/utils';
import * as _ from 'lamb';
import {derived} from 'svelte/store';

import {_selectionData} from 'stores/indicator';
import {sortAscByYear} from 'utils/domain';

const makeTrends = _.pipe([
	_.groupBy(_.getPath('region.id')),
	_.mapValuesWith(sortAscByYear),
	objectToKeyValueArray
]);

export const _trends = derived(_selectionData, makeTrends);
