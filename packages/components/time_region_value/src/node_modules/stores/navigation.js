import * as _ from 'lamb';
import {derived, writable} from 'svelte/store';

import {isSmallScreen} from 'stores/layout';
import {makeClasses} from 'utils/style';

// utils

const activate = id => _.mapValuesWith((value, key) => key === id);

// views

export const defaultViews = {
	barchart: false,
	distribution: true,
	info: false,
	map: false,
	settings: false,
	sidebar: false,
	trends: false,
}
export const views = writable(defaultViews);
export const showView = id => views.update(activate(id));

export const viewsClasses = derived(views, makeClasses);

// routes

export const defaultRoutes = {
	Id: false,
	IdYear: false,
	Index: true,
}
export const routes = writable(defaultRoutes);
export const setRoute = id => routes.update(activate(id));

// timeline visibility

export const isTimelineHidden = derived(
	[isSmallScreen, views],
	([isSmall, views]) => isSmall && (views.info || views.settings)
);
